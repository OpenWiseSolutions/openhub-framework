<beans:beans
        xmlns:beans="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="
             http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
             http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">

    <beans:description>
        Spring security configuration.
    </beans:description>

<!--
    &lt;!&ndash; HTTP basic authentication for web services &ndash;&gt;
    <http pattern="/ws/**">
        <csrf disabled="true"/>
        <intercept-url pattern="/ws/**" access="hasRole('ROLE_WS')"/>
        <http-basic entry-point-ref="authenticationEntryPoint"/>
        <logout/>
    </http>

    &lt;!&ndash; Form based authentication for admin console &ndash;&gt;
    <http entry-point-ref="loginUrlAuthenticationEntryPoint">
        <csrf disabled="true"/>
        <intercept-url pattern="/web/admin/homepage/**" access="permitAll"/>
        <intercept-url pattern="/web/admin/login/**" access="permitAll"/>
        <intercept-url pattern="/web/admin/**" access="hasRole('ROLE_WEB')"/>
        <intercept-url pattern="/web/admin/**/*" access="hasRole('ROLE_WEB')"/>
        <intercept-url pattern="/monitoring/**" access="hasRole('ROLE_MONITORING')"/>
        <form-login
                login-page="/web/admin/login"
                default-target-url="/web/admin/console"
                authentication-failure-url="/web/admin/login?error" />
        <logout logout-success-url="/web/admin/homepage" />
    </http>

    <beans:bean id="authenticationEntryPoint"
                class="org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint">
        <beans:property name="realmName" value="OpenHub - integration platform"/>
    </beans:bean>

    <beans:bean id="loginUrlAuthenticationEntryPoint" class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
        <beans:constructor-arg name="loginFormUrl" value="/web/admin/login" />
    </beans:bean>

    <authentication-manager alias="authManager">
        <authentication-provider>
            <user-service>
                <user name="${ws.user}" password="${ws.password}" authorities="ROLE_WS"/>
                <user name="${web.user}" password="${web.password}" authorities="ROLE_WEB, ROLE_WS, ROLE_MONITORING"/>
                <user name="${monitoring.user}" password="${monitoring.password}" authorities="ROLE_MONITORING"/>
            </user-service>
        </authentication-provider>
    </authentication-manager>

    <beans:bean id="accessDecisionManager" class="org.springframework.security.access.vote.AffirmativeBased">
        <beans:property name="allowIfAllAbstainDecisions" value="true"/>
        <beans:constructor-arg name="decisionVoters">
            <beans:list>
                <beans:bean class="org.springframework.security.access.vote.RoleVoter"/>
            </beans:list>
        </beans:constructor-arg>
    </beans:bean>
-->

</beans:beans>